<!DOCTYPE html>
<html>
  <head>
    <title>Boring Push Ups with Ansible - Edward and Joanna Delaporte</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
	  .remark-slide, .remark-slide-container {
		  background-image: url("static/img/webcon2016/slidesidebar.jpg");
	  }
	  .remark-slide-content {
		  background-image: url("static/img/webcon2016/slidebg.jpg");
	  }
	  img {
		  float:right;
		  border-radius:22px;
	  }
	  img.left {
		  float:left;
	  }
	  img.little {
		  height:200px;
	  }
	  img.capture {
		  border-radius:1px;
	  }
	  img.stretch {
		  width:45%;
		  padding: 10px;
	  }
	  img.flow{
		  width: 100%;
		  padding: 10px;
		  background-color: white;
	  }
    </style>
  </head>
  <body>
<textarea id="source">

# Easy Push-Ups
## Automated Deployment with Ansible

Presented by 

Edward Delaporte, Software Developer for Busey Bank

Joanna Delaporte, Systems Administrator for Parkland College

---

## What is Ansible

- [Simple IT Automation](https://www.ansible.com/)
- Configuration
- Deployment

???

    Introduce/ explain the name Ansible
Our Experience with Ansible

---

## Why Bother With Ansible?

### As a Developer
- I love pushing a big red button and watching my code go live.
- I value *not* being called by my admin between 4 am and 6 am.
- I need to know that the problem I am hunting was not in the deployment.

### As an Administrator
- I love parallel efficiency.
- I value stable custom configuration.
- I need repeatability. 

???

Idea: Add photo of Big Red Button

Developer says: 
File copy is reliable and repeatable, but deployment is a lot more than file copy.
Deployment is: file copy, permissions, web config, app config, host dependencies, host config

Admin says:
The desired state needs to be achieved, no matter how many times I apply a configuration. 
Shells are limited by their environment and available commands. Ansible can do anything python or bash or PowerShell can do. 

---

## Things Ansible Does
- Update a custom web app
- Harden security settings
- Install EPEL
- Setup networking
- Provision a new AWS host!
- Create user accounts
- Update Windows (New!)

???
???
 (Add lots of Examples)

---

## Get Started with Ansible

- [Install Ansible](http://docs.ansible.com/ansible/intro_installation.html) on the Ansible Control Machine
- Write your [Inventory File](http://docs.ansible.com/ansible/intro_inventory.html) on the Ansible Control Machine
- Set up SSH Access to the target machine.
- Set up Sudo rights on the target machine (for most tasks)
- [Ansible Command Line Reference](http://docs.ansible.com/ansible/intro_adhoc.html)

???
???


Tips
- All you need is SSH Access and Sudo rights on the target.
- You need sudo access as normal on the target (most configurations)
- AWS = Amazon Web Services
- pip install boto on the Ansible control machine / hive queen
- Usually start with Root password.
- For AWS, use AWS user secret and secret key as ENV variables or modules arguments.

---

## Example Ansible Inventory File

```
[home]
shockwave
ratchet
admins-mac-mini.local
minecraft.delaporte.us

[vagrant]
192.168.33.10

[remote]
learn.delaporte.us
ansible-chicago-apps
```

???
???

- Anything that SSH can resolve works.
- Short name, IP, FQDN all work.
- .ssh/config short names also work.
- Works with localhost screwy networked virtual machines, too.

---

## Getting Things Done with Ansible

### Start Using Playbooks
- [Ansible Module Index](http://docs.ansible.com/ansible/modules_by_category.html)
- [Ansible Guide to AWS](http://docs.ansible.com/ansible/guide_aws.html)
- [Ansible Galaxy](https://galaxy.ansible.com/)

???

Mention and link to Jeff Gearling and Burt VV - creators of great Ansible roles

Give example commands to check out a playbook from Ansible galaxy.

Show the -VVVV flag. (Debug your playbooks)
Link a Guide to SSH. (Use it to do anything Ansible cannot yet do)

Give example commands to contribute to an Ansible Galaxy playbook.
    Or Link to a Guide to Git? (Use it to track / share your own work.)

---

### Ansible Playbook - Provision an AWS Host

---

### Ansible Playbook - Deploy a Custom Web App

```YAML
- hosts: "{{ hosts }}"
  vars:
    - app_name: "{{ app }}"
    - app_home: "/var/www/{{ app_name }}"
    - app_wsgi: "{{ app_home }}/app.wsgi"
    - git_branch: "{{ branch }}"
  tasks:
    - yum:
        name="{{ item }}"
        state=installed
      with_items:
        - "{{ httpd_service }}"
        - epel-release
        - git
        - mod_wsgi
        - python-pip
        - openssl
        - mod_ssl
    - git: 
        dest="{{ app_home }}" 
        repo="{{ git_repo }}"
        update=yes
        force=yes
        depth=1
        version="{{ git_branch }}"
        accept_hostkey=True
      notify: restart_apache
      tags: update
    # The application database.
    - pip: 
        # executable="/usr/bin/pip-3.2"
        requirements="{{ app_home }}/requirements.txt"
    - name: app readable by apache
      file: 
        path="{{ app_home }}"
        group="{{ httpd_group }}"
        recurse=yes
        mode=776
    - file:
        state=link
        src=/usr/share/zoneinfo/America/Chicago
        dest=/etc/localtime
        force=yes
    - template: src="{{ conf_temp }}" dest="{{ httpd_sites }}/{{ app_name }}.conf"
      notify: restart_apache
      tags: update
    - name: use new config file
      lineinfile:
        dest="{{ httpd_conf }}"
        state=present
        line="include {{ httpd_sites }}/{{ app_name }}.conf"
      notify: restart_apache
    - name: Listen on port 443
      lineinfile:
        dest="{{ httpd_conf }}"
        state=present
        line='Listen 443'
      notify: restart_apache
  handlers:
    - name: restart_apache
      service: name="{{ httpd_service }}" state=restarted
      tags: fixed

```

---

# Answer Questions

---

# Bonus Resources

- [Ansible as Vagrant Provisioner](https://www.vagrantup.com/docs/provisioning/ansible.html)

???
???

Do you like your fellow programmers? Check in an Ansible playbook.

</textarea>
    <!--<script src="https://gnab.github.io/remark/downloads/remark-latest.min.js">-->
    <script src="static/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>
